{"code":"import * as tslib_1 from \"tslib\";\r\nimport * as React from 'react';\r\nimport removeKeys from './removeKeys';\r\nimport key from './uid';\r\nvar blackListProps = ['rowGap', 'columnWidth'];\r\nvar removeBlackListed = removeKeys(blackListProps);\r\nvar Snuggle = /** @class */ (function (_super) {\r\n    tslib_1.__extends(Snuggle, _super);\r\n    function Snuggle() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.reposition = false;\r\n        _this.elements = [];\r\n        _this.grid = null;\r\n        _this.getRef = function (ref) {\r\n            if (ref && ref.firstElementChild) {\r\n                _this.elements.push(ref);\r\n            }\r\n        };\r\n        _this.setValues = function () {\r\n            var _a = _this.props.rowGap, rowGap = _a === void 0 ? 0 : _a;\r\n            if (_this.elements.length === 0)\r\n                return;\r\n            _this.elements.forEach(function (item) {\r\n                var itemRef = item;\r\n                if (itemRef && itemRef.firstElementChild) {\r\n                    var firstElement = itemRef.firstElementChild;\r\n                    var itemHeight = firstElement.getBoundingClientRect().height;\r\n                    var rowSpan = Math.ceil((itemHeight + rowGap) / rowGap);\r\n                    itemRef.style.gridRowEnd = \"span \" + rowSpan;\r\n                }\r\n                return null;\r\n            });\r\n            if (!_this.reposition) {\r\n                window.requestAnimationFrame(_this.setValues);\r\n                _this.reposition = true;\r\n            }\r\n        };\r\n        _this.onLoadImages = function () {\r\n            if (_this.grid) {\r\n                var images = (_this\r\n                    .grid), HTMLElement_1, getElementsByTagName;\r\n                ('img');\r\n                Array.from(images).forEach(function (img) {\r\n                    var imageRef = img;\r\n                    imageRef.onload = function () {\r\n                        _this.setValues();\r\n                    };\r\n                });\r\n            }\r\n        };\r\n        _this.createGridStyle = function () {\r\n            var _a = _this.props, _b = _a.rowGap, rowGap = _b === void 0 ? 0 : _b, _c = _a.columnWidth, columnWidth = _c === void 0 ? 0 : _c;\r\n            return {\r\n                display: 'grid',\r\n                gridGap: rowGap + \"px\",\r\n                gridTemplateColumns: \"repeat(auto-fill, minmax(\" + columnWidth + \"px, 1fr))\",\r\n            };\r\n        };\r\n        return _this;\r\n    }\r\n    Snuggle.prototype.componentDidMount = function () {\r\n        this.setValues();\r\n        this.onLoadImages();\r\n    };\r\n    Snuggle.prototype.componentDidUpdate = function () {\r\n        this.setValues();\r\n    };\r\n    Snuggle.prototype.render = function () {\r\n        var _this = this;\r\n        var _a = this.props, children = _a.children, _b = _a.item, item = _b === void 0 ? React.createElement('div') : _b, _c = _a.container, container = _c === void 0 ? React.createElement('div') : _c, compProps = tslib_1.__rest(_a, [\"children\", \"item\", \"container\"]);\r\n        var hasChildren = React.Children.count(children) > 0;\r\n        if (!hasChildren)\r\n            return null;\r\n        var refItem = function (n) {\r\n            _this.getRef(n);\r\n        };\r\n        var refGrid = function (n) {\r\n            _this.grid = n;\r\n        };\r\n        var renderChildren = React.Children.map(children, function (child) {\r\n            var itemProps = removeBlackListed(tslib_1.__assign({}, item.props, { key: key(), ref: refItem }));\r\n            if (item) {\r\n                return React.createElement(item.type, itemProps, child);\r\n            }\r\n            return null;\r\n        });\r\n        var containerProps = removeBlackListed(tslib_1.__assign({}, container.props, compProps, { ref: refGrid, style: tslib_1.__assign({}, container.props.style, this.createGridStyle()) }));\r\n        return React.createElement(container.type, containerProps, renderChildren);\r\n    };\r\n    Snuggle.defaultProps = {\r\n        columnWidth: 250,\r\n        container: React.createElement('div'),\r\n        item: React.createElement('div'),\r\n        rowGap: 20,\r\n    };\r\n    return Snuggle;\r\n}(React.PureComponent));\r\nexport default Snuggle;\r\n//# sourceMappingURL=index.js.map","map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/index.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/danilowoznica/Projects/significa/react-snuggle/index.d.ts","writeByteOrderMark":false,"text":"import * as React from 'react';\r\ninterface IProp {\r\n    columnWidth?: number;\r\n    container?: React.ReactElement<*>;\r\n    item?: React.ReactElement<*>;\r\n    rowGap?: number;\r\n}\r\ndeclare class Snuggle extends React.PureComponent<IProp> {\r\n    static defaultProps: {\r\n        columnWidth: number;\r\n        container: React.DetailedReactHTMLElement<{}, HTMLElement>;\r\n        item: React.DetailedReactHTMLElement<{}, HTMLElement>;\r\n        rowGap: number;\r\n    };\r\n    reposition: boolean;\r\n    elements: HTMLElement[];\r\n    grid: null | HTMLElement;\r\n    componentDidMount(): void;\r\n    componentDidUpdate(): void;\r\n    getRef: (ref: HTMLElement) => void;\r\n    setValues: () => void;\r\n    onLoadImages: () => void;\r\n    createGridStyle: () => {\r\n        display: string;\r\n        gridGap: string;\r\n        gridTemplateColumns: string;\r\n    };\r\n    render(): React.ReactElement<any, string | ((props: any) => React.ReactElement<any, string | any | (new (props: any) => React.Component<any, any, any>)>) | (new (props: any) => React.Component<any, any, any>)>;\r\n}\r\nexport default Snuggle;\r\n"}}
